!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Tview=t()}(this,function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}var a=function(){function e(){r(this,e),this.subs=[]}return t(e,[{key:"addSub",value:function(e){this.subs.push(e)}},{key:"removeSub",value:function(e){!function(e,t){if(e.length){var n=e.indexOf(t);if(-1<n)e.splice(n,1)}}(this.subs,e)}},{key:"depend",value:function(){window.target&&this.addSub(window.target)}},{key:"notify",value:function(){for(var e=this.subs.slice(),t=0,n=e.length;t<n;t++)e[t].update()}}]),e}();function u(e,t,n,i){Object.defineProperty(e,t,{value:n,enumerable:!!i,writable:!0,configurable:!0})}var s=Object.prototype.hasOwnProperty;var e=Array.prototype,c=Object.create(e);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(o){var a=e[o];u(c,o,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];var n,i=a.apply(this,t),r=this.__ob__;switch(o){case"push":case"unshift":n=t;break;case"splice":n=t.slice(2)}return n&&r.observeArray(n),r.dep.notify(),i})});var f="__proto__"in{},l=Object.getOwnPropertyNames(c),h=function(){function n(e,t){(r(this,n),this.value=e,this.dep=new a,u(e,"__ob__",this),this.vm=t,Array.isArray(e))?((f?d:p)(e,c,l),this.observeArray(e)):this.walk(e)}return t(n,[{key:"walk",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)v(e,t[n]),this.proxyData(t[n])}},{key:"observeArray",value:function(e){for(var t=0,n=e.length;t<n;t++)y(e[t])}},{key:"proxyData",value:function(t){var n=this.vm;Object.defineProperty(n,t,{get:function(){return n.$data[t]},set:function(e){n.$data[t]=e}})}}]),n}();function v(e,t,n){2===arguments.length&&(n=e[t]),"object"===o(n)&&new h(n);var i=y(n),r=new a;Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){return r.depend(),i&&i.dep.depend(),n},set:function(e){n!==e&&(n=e,r.notify())}})}function d(e,t,n){e.__proto__=t}function p(e,t,n){for(var i=0,r=n.length;i<r;i++){var o=n[i];u(e,o,t[o])}}function y(e){var t,n,i;if(console.log(e),null!==(t=e)&&"object"===o(t))return n=e,i="__ob__",s.call(n,i)&&e.__ob__ instanceof h?e.__ob__:new h(e)}var m=function(){function i(e,t,n){r(this,i),this.vm=e,this.cb=n,this.getter=function(e){if(b.test(e))return;var n=e.split(".");return function(e){for(var t=0;t<n.length;t++){if(!e)return;e=e[n[t]]}return e}}(t),this.value=this.get()}return t(i,[{key:"get",value:function(){var e=(window.target=this).vm,t=this.getter.call(e,e);return window.target=void 0,t}},{key:"update",value:function(){var e=this.value;this.value=this.get(),this.cb.call(this.vm,this.value,e)}}]),i}(),b=/[^\w.$]/;var g=document,n=function(){function n(e,t){r(this,n),this.$el=g.querySelector(e),this.$vm=t,this.$el&&(this.$fragment=this.node2Fragment(this.$el),this.compile(this.$fragment),this.$el.appendChild(this.$fragment))}return t(n,[{key:"node2Fragment",value:function(e){for(var t,n=g.createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}},{key:"compile",value:function(e){var a=this,t=e.childNodes;Array.from(t).forEach(function(o){if(console.log(o),a.isElement(o)){var e=o.attributes;Array.from(e).forEach(function(e){var t=e.name,n=e.value;if(a.isDirective(t)){var i=t.substring(2);a[i]&&a[i](o,a.$vm,n)}if(a.isEvent(t)){var r=t.substring(1);a.eventHandler(o,a.$vm,n,r)}})}else a.isInterpolation(o)&&a.compileText(o);o.childNodes&&0<o.childNodes.length&&a.compile(o)})}},{key:"compileText",value:function(e){this.update(e,this.$vm,RegExp.$1,"text")}},{key:"update",value:function(t,e,n,i){var r=this[i+"Updater"];r&&r(t,e[n]),new m(e,n,function(e){r&&r(t,e)})}},{key:"text",value:function(e,t,n){this.update(e,t,n,"text")}},{key:"model",value:function(e,t,n){this.update(e,t,n,"model"),e.addEventListener("input",function(e){t[n]=e.target.value})}},{key:"modelUpdater",value:function(e,t){e.value=t}},{key:"html",value:function(e,t,n){this.update(e,t,n,"html")}},{key:"htmlUpdater",value:function(e,t){e.innerHTML=t}},{key:"textUpdater",value:function(e,t){e.textContent=t}},{key:"eventHandler",value:function(e,t,n,i){var r=t.$options.methods&&t.$options.methods[n];i&&r&&e.addEventListener(i,r.bind(t))}},{key:"isDirective",value:function(e){return 0==e.indexOf("t-")}},{key:"isEvent",value:function(e){return 0==e.indexOf("@")}},{key:"isElement",value:function(e){return 1===e.nodeType}},{key:"isInterpolation",value:function(e){return 3===e.nodeType&&/\{\{(.*)\}\}/.test(e.textContent)}}]),n}();return function e(t){r(this,e),this.$options=t,this.$data=t.data,new h(this.$data,this),new n(t.el,this),t.created&&t.created.call(this)}});
//# sourceMappingURL=Tview.min.js.map
